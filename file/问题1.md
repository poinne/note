

论文1中通过下面的方法来计算顶点的梯度的绝对值：

![image-20241205231553989](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241205231553989.png)

其中，梯度的计算使用论文2中的方法，论文2中的方法如下：

![image-20241205231520484](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241205231520484.png)

（论文2中，$\phi$不是代表水平集函数，而是定义在三角网格上的分段函数，$u$是水平集函数）。这个公式的意思是，面$\tau$的水平集梯度为面上三个顶点的水平集值与顶点分段函数的梯度的乘积之和。并且论文中提到，顶点分段函数的梯度是一个常量，可事先计算保存到顶点中。

论文1对应的公式为：

![image-20241205233848883](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241205233848883.png)

括号里就是三角形面的水平集梯度，通过面中顶点线性插值得到

![image-20241205233842311](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241205233842311.png)

![image-20241205233924595](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241205233924595.png)
$$
A = \frac{a}{\left| a\right| } = \frac{{v}_{j} - {v}_{k}}{\left| {v}_{j} - {v}_{k}\right| }\;B = \frac{b}{\left| b\right| } = \frac{{v}_{l} - {v}_{j}}{\left| {v}_{l} - {v}_{j}\right| }
$$
