laplace方法通过解线性方程组$Ax = b$，将边界点上的标量值作为b，A为cot权的laplace矩阵，解x。

mvc方法通过遍历所有内部顶点，对于每个内部点，计算所有边界点对于该点的权重，将所有边界点的加权值作为该点的标量值。边界点权重的计算公式为：

![image-20241008133623889](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008133623889.png)

mapping时，先将非凸网格通过tutte embedding参数化成边界为圆的网格，然后再固定边界点，根据MD能量对内部顶点进行优化。（网上找到的代码并没有固定边界点，所以我在优化的循环中，直接令边界点计算出的梯度等于0，以固定边界点，不知道对不对）

mapping 后的woody网格：

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008121906051.png" alt="image-20241008124315043" style="zoom:67%;" />

##### woody 对比（边界标量值一半为1，一半为0）

######  laplace 结果

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008124315043.png" alt="image-20241008121906051" style="zoom:67%;" />

###### woody mvc 结果（mapping 时 通过tutte embedding将边界映射为半径为1的圆，r = 1）

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008122218172.png" alt="image-20241008122218172" style="zoom:67%;" />

###### woody mvc (mapping r = 10)

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008125329146.png" alt="image-20241008125329146" style="zoom:67%;" />

###### woody mvc 结果（mapping 时 r = 100）

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008131312228.png" alt="image-20241008122156266" style="zoom:67%;" />

###### woody mvc 结果（mapping 时 r = 500）

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008131312228.png" alt="image-20241008122156266" style="zoom:67%;" />

###### laplace 与mvc (r = 1) 对比：

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008122156266.png" alt="image-20241008130404196" style="zoom:67%;" />

数值差绝对值sum：124.772。

在tutte embedding 将输入网格参数化为边界为1的圆的情况下，以参数化后的网格作为输入，在对内部对进行优化时，会出现：

![image-20241008131312228](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008125411671.png)

可能是这里导致最终结果差的原因。



###### laplace 与 mvc (r = 10)对比

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008124149965.png" alt="image-20241008125411671" style="zoom:67%;" />

数值差绝对值sum：28.9627。



###### laplace 与 mvc (r = 100)对比

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008123108545.png" alt="image-20241008122338898" style="zoom:67%;" />

数值差绝对值sum：31.0483。



###### laplace 与 mvc (r = 500)对比

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008122338898.png" alt="image-20241008124149965" style="zoom:67%;" />

数值差绝对值sum：29.6111。





#### 其它模型对比

##### Balls_tutte（边界标量值一半为1，一半为0）

经过tutte embedding后的凸的网格

###### Balls laplace 结果

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008123147954.png" alt="image-20241008123108545" style="zoom:67%;" />

###### Balls mvc 结果

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008130404196.png" alt="image-20241008123051341" style="zoom:67%;" />

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008123051341.png" alt="image-20241008132730246" style="zoom:67%;" />

###### Balls laplace 与 mvc 对比

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008143500393.png" alt="image-20241008123147954" style="zoom:67%;" />

数值差绝对值sum：3.79444。



##### cow_tutte（边界标量值一半为1，一半为0）

经过tutte embedding后的凸的网格

mapping后：

![image-20241008143612380](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008143401056.png)

###### cow laplace 结果

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008143612380.png" alt="image-20241008143419843" style="zoom:67%;" />

###### cow mvc 结果

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008132730246.png" alt="image-20241008143401056" style="zoom:67%;" />

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008143712071.png" alt="image-20241008143712071" style="zoom:67%;" />



###### cow laplace 与 mvc 对比

<img src="https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008143419843.png" alt="image-20241008143500393" style="zoom:67%;" />

数值差绝对值sum：75.4999。



#### 不同边界条件对比

##### 边界顶点0 、1 数量不同的对比

###### laplace

![image-20241008135119509](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008135119509.png)

###### mvc

![image-20241008135314484](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008140744060.png)

###### 对比

![image-20241008135516188](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008135314484.png)

绝对值之和分别为：21.5537、32.9729、28.9627、32.9729。



##### 边界标量值不同的对比

左图为边界值0、1、2各占1 / 3

右图为边界值0、1、2、3各占1 / 4

###### laplace

![image-20241008140744060](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008141100895.png)

###### mvc

![image-20241008140943827](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008140943827.png)

###### 对比

![image-20241008141100895](https://raw.githubusercontent.com/poinne/md-pic/main/image-20241008135516188.png)

绝对值之和分别为：81.4035、132.686。



综上，相比于mvc，laplace受参数化结果和边界标量值的影响更小。而mvc更容易受到这些因素的影响。

